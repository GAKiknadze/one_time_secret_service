<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Get Secret</title>
        <link rel="stylesheet" href="/static/styles.css">
    </head>
    <body>
        <div id="container">
            <h1>ğŸ”“ View Secret</h1>
            <div class="description">
                <p>You've been sent a secure message. Click the button below to reveal it.</p>
                <p class="warning">âš ï¸ Warning: This secret can only be viewed once. After that, it will be permanently deleted.</p>
            </div>
            
            <div class="form-section">
                <form id="form_get_secret">
                    <button type="submit" class="btn btn-primary btn-large">ğŸ‘ï¸ Reveal Secret</button>
                </form>
            </div>
            
            <div id="result" class="result-section" hidden>
                <h3>Your Secret Message</h3>
                <p class="result-description">This message will be deleted from our servers now:</p>
                <textarea type="text" id="secret_value" readonly></textarea>
                <button type="button" onclick="copyToClipboard('secret_value')" class="btn btn-success">ğŸ“‹ Copy Secret</button>
                <p class="note">This link is now expired and cannot be used again.</p>
            </div>
        </div>
        <script src="/static/scripts.js"></script>
        <script>
            document.getElementById('form_get_secret').addEventListener('submit', async function(event) {
                event.preventDefault();
                const secretId = document.location.pathname.split('/').pop();
                const response = await fetch('/api/get', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: new URLSearchParams({
                        'id': secretId
                    })
                });
                showResult('result');
                if (!response.ok) {
                    document.getElementById('secret_value').value = 'Error retrieving secret';
                    return;
                }
                const data = await response.json();
                document.getElementById('secret_value').value = data.secret || 'Error retrieving secret';
            });
        </script>
    </body>
</html>